<template>
  <div id="room" class="viewBox">
    <Title>
      <template #text>
        等待玩家加入中 ... {{ joinedPlayerAmount }} / {{ playerAmount }}
      </template>
    </Title>
    <div class="subViewBox">
      <h2 style="margin: 0; text-align: center;">遊戲間 ID: <span class="roomId">{{ roomId }} <i class="pi pi-copy"></i></span></h2>
      <DataTable>
        <Column />
      </DataTable>
    </div>
  </div>
</template>

<script>
import DataTable from 'primevue/datatable'
import Column from 'primevue/column'

import { mapState } from 'vuex'

export default {
  name: 'Room',
  components: {
    DataTable,
    Column
  },
  computed: {
    ...mapState('room', ['roomId', 'playerAmount', 'joinedPlayerAmount', 'playerList'])
  },
  beforeRouteEnter (to, from, next) {
    next(vm => {
      if (!vm.$socket.connected) {
        next('/play')
      }

      // if (JSON.stringify(to.query) !== '{}') {
      //   vm.roomId = to.query.roomId
      //   vm.playerAmount = to.query.playerAmount
      // }
    })
  }
}
</script>

<style lang="scss">
  #room {
    padding: 0 4rem 6rem;

    .roomId {
      display: inline-block;
      padding: 0.5rem 1rem;
      background-color: var(--color-info);
      border-radius: 9999px;

      i {
        cursor: pointer;
        font-size: 1.4rem;
        transition: transform .3s;
        &:hover {
          transform: scale(1.1);
        }
      }
    }
  }
</style>
